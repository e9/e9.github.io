<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    

    <title>Hugoで記事を書くまで - e9.github.io</title>

    


    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"
      integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk"
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="/css/styles.css" />
  </head>

  <body>
    <nav
      class="navbar "
    >
      <div class="container">
        <a
          class="navbar-brand"
          href="https://e9.github.io"
          style="font-weight: 800; font-family: 'Open Sans', 'Helvetica Neue', Helvetica, Arial, sans-serif; "
          >e9.github.io</a
        >
      </div>
    </nav>

    

    <main class="container">
      <div class="row">
        <div class="col-md-9">
<article>
    
    <h2 class="post-item post-title">
        <a href="https://e9.github.io/posts/1535546215/">Hugoで記事を書くまで</a>
    </h2>
    <div class="post-item post-meta">
        <span
  ><ion-icon name="today"></ion-icon>&nbsp;2018-08-29</span
><span
  ><ion-icon name="pricetags"></ion-icon
  >&nbsp;No tag</span
>

    </div>
    
    
    <div class="post-content markdown-body">
        <p>マークダウンで書けるブログサービスの選択肢が少ないのでgithub.ioを使うことにした。
いまどきはJekyllよりHugoらしい。わりと簡単に作れた。こんな感じで。</p>
<pre><code class="language-sh">hugo new site blog
cd blog
git init
git remote add origin git@github.com:e9/blog.git
</code></pre>
<p>空のディレクトリばかりなのでfirst commitの前に.gitkeepを置いておく。</p>
<pre><code class="language-sh">for dir in `find . -not -path '*/\.*' -not -name '.*' -type d`; do touch $dir/.gitkeep; done
git add .
git commit -m 'hugo new site'
</code></pre>
<p>テーマはダウンロードして直接置いてもいいけど、gitのsubmoduleにしておくのがスマートだろう。</p>
<pre><code class="language-sh">git submodule add https://github.com/mismith0227/hugo_theme_pickles.git themes/pickles
git add .
git commit -m 'Add themes/pickles'
</code></pre>
<p>あとはpublicをgithub.ioのレポジトリのsubmoduleにして、publicに出力したファイルをpushするのがオーソドックスなやり方らしいんだけど、せっかくなんでCIサービスから自動でデプロイさせることにした。</p>
<p>いまどきはgithubのプライベートレポジトリは作り放題だし、Circle CIは1コンテナだけなら無料で使える。</p>
<p>.circleci/config.ymlはこんな感じ。あらかじめCircleCIの鍵をGitHubに登録しておく。</p>
<pre><code class="language-yaml">version: 2
jobs:
  build:
    branches:
      only:
        - master
    docker:
      - image: circleci/golang:stretch
    steps:
      - checkout
      - run:
          command: git submodule update --init --recursive
      - run:
          command: |
            git clone https://github.com/e9/e9.github.io.git public
            rm -rf public/*
      - run:
          command: |
            wget https://github.com/gohugoio/hugo/releases/download/v0.47.1/hugo_0.47.1_Linux-64bit.tar.gz
            tar xzf hugo_0.47.1_Linux-64bit.tar.gz
            ./hugo -v
      - run:
          environment:
            EMAIL: &lt;&gt;
            GIT_AUTHOR_NAME: CircleCI
            GIT_COMMITTER_NAME: CircleCI
          command: |
            cd public
            git add .
            git commit -m 'rebuilding site'
            git push origin master
</code></pre>
<p>.travis.ymlならこんな感じ。あらかじめ環境変数CI_USER_TOKENに値を入れておく。</p>
<pre><code class="language-yaml">language: go
sudo: false
dist: trusty
before_install:
- echo -e &quot;machine github.com\n  login $CI_USER_TOKEN&quot; &gt; ~/.netrc
install:
- wget https://github.com/gohugoio/hugo/releases/download/v0.47.1/hugo_0.47.1_Linux-64bit.tar.gz
- tar xzf hugo_0.47.1_Linux-64bit.tar.gz
before_script:
- git clone https://github.com/e9/e9.github.io.git public
- rm -rf public/*
script:
- ./hugo -v
deploy:
  provider: script
  script: (cd public &amp;&amp; git add . &amp;&amp; git commit -m 'rebuilding site' &amp;&amp; git push origin master)
  skip_cleanup: true
  on:
    branch: master
</code></pre>
<p>新しい記事を書くときに<code>hugo new f.md</code>だとトップページに反映されなかった。<code>hugo new d/f.md</code>とひとつ階層を切らないといけないようだ。</p>

    </div>
</article>



</div>
        <aside class="col-md-3"><aside>
  <div>
    <ul class="list-unstyled">
      

      <li>
        <a href="/">Home</a>
      </li>
      

      <li>
        <a href="/index.xml">RSS</a>
      </li>
      

    </ul>
  </div>

  <div>
    <ul class="list-unstyled">
      

      <li>
        <a href="/archives/2020/04/">2020/04</a>
      </li>
      

      <li>
        <a href="/archives/2019/01/">2019/01</a>
      </li>
      

      <li>
        <a href="/archives/2018/12/">2018/12</a>
      </li>
      

      <li>
        <a href="/archives/2018/11/">2018/11</a>
      </li>
      

      <li>
        <a href="/archives/2018/10/">2018/10</a>
      </li>
      

      <li>
        <a href="/archives/2018/09/">2018/09</a>
      </li>
      

      <li>
        <a href="/archives/2018/08/">2018/08</a>
      </li>
      

      <li>
        <a href="/archives/2016/05/">2016/05</a>
      </li>
      

      <li>
        <a href="/archives/2016/03/">2016/03</a>
      </li>
      

      <li>
        <a href="/archives/2016/02/">2016/02</a>
      </li>
      

      <li>
        <a href="/archives/2014/04/">2014/04</a>
      </li>
      

      <li>
        <a href="/archives/2014/03/">2014/03</a>
      </li>
      

      <li>
        <a href="/archives/2012/08/">2012/08</a>
      </li>
      

      <li>
        <a href="/archives/2012/07/">2012/07</a>
      </li>
      

      <li>
        <a href="/archives/2012/06/">2012/06</a>
      </li>
      

      <li>
        <a href="/archives/2012/05/">2012/05</a>
      </li>
      

      <li>
        <a href="/archives/2012/04/">2012/04</a>
      </li>
      

    </ul>
  </div>

  <div>
    <ul class="list-unstyled">
      

      <li>
        <a href="https://github.com/e9" target="_blank">GitHub</a>
      </li>
      

      <li>
        <a href="https://twitter.com/sfc" target="_blank">Twitter</a>
      </li>
      

    </ul>
  </div>
</aside>
</aside>
      </div>
    </main>

    <footer></footer>
  </body>
</html>
